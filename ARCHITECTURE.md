# Git Message MCP æ¶æ„è®¾è®¡æ–‡æ¡£

## ğŸ“ ç³»ç»Ÿæ¶æ„

### é«˜å±‚æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MCP Client (e.g., Cursor)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ é€šè¿‡ stdio é€šä¿¡
                     â”‚ (FastMCP Protocol)
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚              FastMCP Server (Git Message MCP)                        â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           Tool 1: listAvailableModels                       â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚   è·å– POE ä¸­æ‰€æœ‰å¯ç”¨æ¨¡å‹åˆ—è¡¨                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           Tool 2: generateGitMessage                        â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚   â”‚ 1. å‚æ•°éªŒè¯ä¸åˆå§‹åŒ–                                   â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - æ£€æŸ¥æ–‡ä»¶å¤¹å­˜åœ¨æ€§                                 â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - éªŒè¯ Git ä»“åº“                                    â”‚  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                          â–¼                                    â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚   â”‚ 2. Git ä¿¡æ¯æ”¶é›†                                       â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - getGitDiffStats()   - ç»Ÿè®¡æ•°æ®                  â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - getChangedFiles()   - æ”¹åŠ¨æ–‡ä»¶åˆ—è¡¨              â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - getGitDiffContent() - Diff å†…å®¹                â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - getRecentCommits()  - æœ€è¿‘æäº¤                 â”‚  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                          â–¼                                    â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚   â”‚ 3. AI æç¤ºè¯æ„å»º                                      â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - buildPrompt()                                     â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - æ ¹æ® messageType é€‰æ‹©ä¸åŒçš„æç¤º                 â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - åˆå¹¶ä¸Šä¸‹æ–‡ä¿¡æ¯                                   â”‚  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                          â–¼                                    â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚   â”‚ 4. POE API è°ƒç”¨                                       â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - generateMessageWithAI()                           â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - å‘é€ HTTP POST è¯·æ±‚åˆ° POE                       â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - ä½¿ç”¨æŒ‡å®šæ¨¡å‹ç”Ÿæˆ message                         â”‚  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                          â–¼                                    â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚   â”‚ 5. ç»“æœå¤„ç†                                            â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - å¯é€‰è¿½åŠ ç»Ÿè®¡ä¿¡æ¯                                 â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - éªŒè¯è¿”å›å†…å®¹                                     â”‚  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                          â–¼                                    â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚   â”‚ 6. å‰ªè´´æ¿æ“ä½œ                                          â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - copyToClipboard()                                 â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - ä½¿ç”¨ pbcopy å‘½ä»¤                                  â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - å¼‚æ­¥å¤„ç†ï¼Œå¸¦è¶…æ—¶æ§åˆ¶                             â”‚  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                          â–¼                                    â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚   â”‚ 7. è¿”å›ç»“æœ                                            â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - success æ ‡å¿—                                      â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - ç”¨æˆ·å‹å¥½çš„æ¶ˆæ¯                                   â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - è¯¦ç»†ä¿¡æ¯å¯¹è±¡                                     â”‚  â”‚   â”‚
â”‚  â”‚   â”‚    - ç”Ÿæˆçš„å®Œæ•´ message                              â”‚  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                         â”‚
                  â–¼                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Local Git Repo  â”‚      â”‚  POE API         â”‚
        â”‚  (git commands)  â”‚      â”‚  (axios HTTP)    â”‚
        â”‚                  â”‚      â”‚                  â”‚
        â”‚ - git diff       â”‚      â”‚ /models          â”‚
        â”‚ - git log        â”‚      â”‚ /chat/completionsâ”‚
        â”‚ - git status     â”‚      â”‚                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                         â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  System Output  â”‚
                        â”‚                 â”‚
                        â”‚ - Clipboard     â”‚
                        â”‚ - Return Data   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ æ¨¡å—åŒ–è®¾è®¡

### æ ¸å¿ƒæ¨¡å—åˆ’åˆ†

```typescript
// ======================== POE API æ¨¡å— ========================

async function getAvailableModels(): Promise<string[]>
  // ä½œç”¨ï¼šè·å–æ¨¡å‹åˆ—è¡¨
  // ä¾èµ–ï¼šaxios, POE_API_KEY
  // è¿”å›ï¼šæ¨¡å‹åç§°æ•°ç»„

async function generateMessageWithAI(
  content: string,
  model: string,
  messageType: string
): Promise<string>
  // ä½œç”¨ï¼šè°ƒç”¨ POE API ç”Ÿæˆ message
  // ä¾èµ–ï¼šbuildPrompt(), axios, POE API
  // è¿”å›ï¼šAI ç”Ÿæˆçš„ message

function buildPrompt(
  gitInfo: string,
  messageType: string
): string
  // ä½œç”¨ï¼šæ ¹æ®æ¶ˆæ¯ç±»å‹æ„å»ºæç¤ºè¯
  // ä¾èµ–ï¼šæ— 
  // è¿”å›ï¼šå®Œæ•´çš„ AI æç¤ºè¯

// ======================== Git æ“ä½œæ¨¡å— ========================

function getGitDiffStats(folderPath: string): {...}
  // ä½œç”¨ï¼šè·å– git diff ç»Ÿè®¡
  // ä¾èµ–ï¼šchild_process
  // è¿”å›ï¼š{filesChanged, insertions, deletions, summary}

function getChangedFiles(folderPath: string): string[]
  // ä½œç”¨ï¼šè·å–æ”¹åŠ¨æ–‡ä»¶åˆ—è¡¨
  // ä¾èµ–ï¼šchild_process
  // è¿”å›ï¼šæ–‡ä»¶è·¯å¾„æ•°ç»„

function getGitDiffContent(folderPath: string): string
  // ä½œç”¨ï¼šè·å– git diff åŸå§‹å†…å®¹ï¼ˆé™åˆ¶å¤§å°ï¼‰
  // ä¾èµ–ï¼šchild_process
  // è¿”å›ï¼šdiff å­—ç¬¦ä¸²ï¼ˆæœ€å¤§ 10KBï¼‰

function getRecentCommitMessages(folderPath: string): string[]
  // ä½œç”¨ï¼šè·å–æœ€è¿‘çš„ commit æ¶ˆæ¯
  // ä¾èµ–ï¼šchild_process
  // è¿”å›ï¼šcommit æ¶ˆæ¯æ•°ç»„

// ======================== ç³»ç»Ÿæ“ä½œæ¨¡å— ========================

async function copyToClipboard(text: string): Promise<boolean>
  // ä½œç”¨ï¼šå¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿
  // ä¾èµ–ï¼šchild_process (pbcopy)
  // è¿”å›ï¼šæ“ä½œæ˜¯å¦æˆåŠŸ
```

---

## ğŸ”„ æ•°æ®æµ

### å®Œæ•´è¯·æ±‚å¤„ç†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. MCP å®¢æˆ·ç«¯å‘é€è¯·æ±‚            â”‚
â”‚ {                                â”‚
â”‚   tool: "generateGitMessage",   â”‚
â”‚   parameters: {...}              â”‚
â”‚ }                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. FastMCP è·¯ç”±åˆ°å¯¹åº”å·¥å…·        â”‚
â”‚ server.addTool() å¤„ç†è¯·æ±‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. å‚æ•°éªŒè¯ (Zod)               â”‚
â”‚ - folderPath: å¿…éœ€å­—ç¬¦ä¸²          â”‚
â”‚ - model: å¯é€‰å­—ç¬¦ä¸²ï¼ˆé»˜è®¤å€¼ï¼‰     â”‚
â”‚ - messageType: å¯é€‰æšä¸¾           â”‚
â”‚ - includeStats: å¯é€‰å¸ƒå°”å€¼        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ                   â”‚
â”‚ try {                             â”‚
â”‚   - éªŒè¯æ–‡ä»¶å¤¹                   â”‚
â”‚   - éªŒè¯ Git ä»“åº“               â”‚
â”‚   - æ”¶é›† Git ä¿¡æ¯                â”‚
â”‚   - æ„å»º AI æç¤ºè¯              â”‚
â”‚   - è°ƒç”¨ POE API                â”‚
â”‚   - å¤„ç†è¿”å›ç»“æœ                â”‚
â”‚   - å¤åˆ¶åˆ°å‰ªè´´æ¿                â”‚
â”‚ } catch (error)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. è¿”å›å“åº”å¯¹è±¡                   â”‚
â”‚ {                                â”‚
â”‚   success: boolean,               â”‚
â”‚   message: string,                â”‚
â”‚   details: {...}                  â”‚
â”‚ }                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. MCP å®¢æˆ·ç«¯æ¥æ”¶å“åº”            â”‚
â”‚ æ˜¾ç¤ºæ¶ˆæ¯ã€ä½¿ç”¨ç”Ÿæˆçš„ message      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ è®¾è®¡åŸåˆ™

### 1. å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰
æ¯ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹ï¼š
- `getGitDiffStats` - ä»…è·å–ç»Ÿè®¡
- `buildPrompt` - ä»…æ„å»ºæç¤º
- `generateMessageWithAI` - ä»…è°ƒç”¨ API
- `copyToClipboard` - ä»…å¤„ç†å‰ªè´´æ¿

### 2. å…³æ³¨åˆ†ç¦»
- **Git å±‚**: æ‰€æœ‰ git æ“ä½œ
- **AI å±‚**: æ‰€æœ‰ POE API ç›¸å…³
- **ç³»ç»Ÿå±‚**: å‰ªè´´æ¿ã€è¿›ç¨‹ç®¡ç†
- **ä¸šåŠ¡å±‚**: å·¥å…·å®šä¹‰å’Œæµç¨‹ç¼–æ’

### 3. é”™è¯¯å¤„ç†
æ¯ä¸€å±‚éƒ½æœ‰ç‹¬ç«‹çš„é”™è¯¯å¤„ç†ï¼š
```typescript
// å±‚çº§å¼é”™è¯¯å¤„ç†
try {
  // ä¸šåŠ¡é€»è¾‘
} catch (error: any) {
  // ä¸Šå±‚æ•è·ï¼Œè¿”å›å‹å¥½é”™è¯¯
  return { success: false, message: `âŒ é”™è¯¯: ${error.message}` }
}
```

### 4. å¯æ‰©å±•æ€§
- æ”¯æŒæ–°çš„ messageTypeï¼ˆä¿®æ”¹ buildPromptï¼‰
- æ”¯æŒæ–°çš„ AI æä¾›å•†ï¼ˆå°è£…æˆç‹¬ç«‹å‡½æ•°ï¼‰
- æ”¯æŒä¸åŒçš„å‰ªè´´æ¿å®ç°ï¼ˆä¿®æ”¹ copyToClipboardï¼‰

---

## ğŸƒ æ‰§è¡Œæµç¨‹æ—¶åºå›¾

```
MCP Client          FastMCP            Git Module         POE API          System
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚â”€â”€è¯·æ±‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚â”€â”€éªŒè¯æ–‡ä»¶å¤¹â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                â”‚                â”‚
    â”‚                â”‚â—€â”€è¿”å›(âœ“)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚â”€â”€è·å–diffç»Ÿè®¡â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                â”‚                â”‚
    â”‚                â”‚â—€â”€ç»Ÿè®¡æ•°æ®â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚â”€â”€è·å–diffå†…å®¹â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                â”‚                â”‚
    â”‚                â”‚â—€â”€diffå­—ç¬¦ä¸²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚â”€â”€æ„å»ºæç¤ºè¯â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚(å†…éƒ¨å¤„ç†)       â”‚                â”‚
    â”‚                â”‚â—€â”€æç¤ºè¯â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚â”€â”€è°ƒç”¨POE APIâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚â—€â”€â”€ç”Ÿæˆmessageâ”€â”‚
    â”‚                â”‚â—€â”€â”€è¿”å›messageâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚â”€â”€å¤„ç†è¿”å›ç»“æœ       â”‚                â”‚                â”‚
    â”‚                â”‚(è¿½åŠ ç»Ÿè®¡ç­‰)        â”‚                â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚â”€â”€å¤åˆ¶åˆ°å‰ªè´´æ¿â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚â—€â”€â”€æˆåŠŸ/å¤±è´¥â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
    â”‚â—€â”€è¿”å›ç»“æœ+æ¶ˆæ¯â”€â”‚                     â”‚                â”‚                â”‚
    â”‚                â”‚                     â”‚                â”‚                â”‚
```

---

## ğŸ’¾ æ•°æ®ç»“æ„

### æ ¸å¿ƒè¿”å›ç±»å‹

```typescript
// Tool: generateGitMessage è¿”å›ç±»å‹
interface GenerateGitMessageResponse {
  success: boolean;              // æ“ä½œæ˜¯å¦æˆåŠŸ
  message: string;               // ç”¨æˆ·å‹å¥½çš„æ¶ˆæ¯
  details?: {                    // æ“ä½œè¯¦æƒ…
    folderPath: string;          // åˆ†æçš„æ–‡ä»¶å¤¹è·¯å¾„
    folderName: string;          // æ–‡ä»¶å¤¹åç§°
    filesChanged: number;        // æ”¹åŠ¨æ–‡ä»¶æ•°
    insertions: number;          // æ’å…¥è¡Œæ•°
    deletions: number;           // åˆ é™¤è¡Œæ•°
    messageType: string;         // ä½¿ç”¨çš„æ¶ˆæ¯ç±»å‹
    model: string;               // ä½¿ç”¨çš„ AI æ¨¡å‹
    copiedToClipboard: boolean;  // æ˜¯å¦æˆåŠŸå¤åˆ¶
    generatedMessage: string;    // ç”Ÿæˆçš„å®Œæ•´ message
  }
}

// Git ç»Ÿè®¡æ•°æ®
interface GitStats {
  filesChanged: number;
  insertions: number;
  deletions: number;
  summary: string;
}
```

---

## ğŸ”’ å®‰å…¨æœºåˆ¶

### 1. API Key ç®¡ç†
- âœ… å­˜å‚¨åœ¨å¸¸é‡ä¸­ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- âš ï¸ ç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨ç¯å¢ƒå˜é‡
- ğŸ” ä¸åœ¨æ—¥å¿—ä¸­è¾“å‡º

### 2. è¾“å…¥éªŒè¯
- Zod å®Œæ•´å‚æ•°éªŒè¯
- æ–‡ä»¶å¤¹å­˜åœ¨æ€§æ£€æŸ¥
- Git ä»“åº“éªŒè¯
- Diff å¤§å°é™åˆ¶ï¼ˆ10KBï¼‰

### 3. è¾“å‡ºå®‰å…¨
- é”™è¯¯æ¶ˆæ¯è„±æ•
- ä¸æš´éœ²å†…éƒ¨è·¯å¾„
- ä¸è¾“å‡ºå®Œæ•´ diffï¼ˆä»…å‰ 10KBï¼‰

### 4. æµç¨‹éš”ç¦»
- å„å‡½æ•°ç‹¬ç«‹æ‰§è¡Œ
- é”™è¯¯ä¸ä¼ æ’­åˆ°ä¸Šå±‚
- è¶…æ—¶ä¿æŠ¤ï¼ˆå‰ªè´´æ¿æ“ä½œ 5ç§’ï¼‰

---

## âš¡ æ€§èƒ½è€ƒè™‘

### 1. ç¼“å­˜æœºåˆ¶ï¼ˆå¯è€ƒè™‘ï¼‰
- æ¨¡å‹åˆ—è¡¨ç¼“å­˜ï¼ˆå‡å°‘ API è°ƒç”¨ï¼‰
- Diff å†…å®¹ç¼“å­˜ï¼ˆåŒä¸€æ—¶é—´æ®µï¼‰

### 2. å¤§å°é™åˆ¶
- Diff å†…å®¹: 10KBï¼ˆé˜²æ­¢ API è¶…è½½ï¼‰
- æœ€è¿‘æäº¤: 3 æ¡ï¼ˆè¶³å¤Ÿå‚è€ƒï¼‰
- æ”¹åŠ¨æ–‡ä»¶: æ— é™åˆ¶

### 3. å¹¶å‘å¤„ç†
- å¼‚æ­¥ copyToClipboard()
- å¹¶å‘èƒ½åŠ›ç”± POE API å†³å®š
- å»ºè®®å•ä¸ªè¯·æ±‚å¤„ç†

### 4. è¶…æ—¶ä¿æŠ¤
```typescript
// å‰ªè´´æ¿æ“ä½œè¶…æ—¶
setTimeout(() => resolve(false), 5000)

// Git å‘½ä»¤æ‰§è¡Œï¼ˆç”± child_process æ§åˆ¶ï¼‰
stdio: ["pipe", "pipe", "pipe"]
```

---

## ğŸ”§ æ‰©å±•ç‚¹

### å¦‚ä½•æ·»åŠ æ–°çš„æ¶ˆæ¯æ ¼å¼

1. åœ¨ `messageType` å‚æ•°ä¸­æ·»åŠ æ–°çš„æšä¸¾å€¼
2. åœ¨ `buildPrompt` ä¸­æ·»åŠ å¯¹åº”çš„åˆ†æ”¯
3. è¿”å›æ ¼å¼åŒ–çš„æç¤ºè¯

```typescript
// ç¤ºä¾‹ï¼šæ·»åŠ  "academic" æ ¼å¼
if (messageType === "academic") {
  return basePrompt + `Generate an academic paper abstract style commit message...`;
}
```

### å¦‚ä½•æ·»åŠ æ–°çš„ Git ä¿¡æ¯

1. åˆ›å»ºæ–°çš„ `getGitXxx()` å‡½æ•°
2. åœ¨ `generateGitMessage` å·¥å…·ä¸­è°ƒç”¨
3. å°†ç»“æœåˆå¹¶åˆ°ä¸Šä¸‹æ–‡ä¿¡æ¯ä¸­

```typescript
const customInfo = getGitCustomInfo(folderPath);
aiContext += `\nCustom Info:\n${customInfo}`;
```

### å¦‚ä½•æ”¯æŒæ–°çš„å¹³å°

ä¿®æ”¹ `copyToClipboard` å‡½æ•°ï¼š
```typescript
// Windows
if (process.platform === 'win32') {
  const cmd = 'clip'; // Windows å‘½ä»¤
}
// Linux
if (process.platform === 'linux') {
  const cmd = 'xclip -selection clipboard'; // Linux å‘½ä»¤
}
```

---

## ğŸ“Š ä¾èµ–å…³ç³»å›¾

```
index.ts
â”œâ”€ FastMCP æ¡†æ¶
â”‚  â””â”€ Zod (å‚æ•°éªŒè¯)
â”œâ”€ axios (HTTP å®¢æˆ·ç«¯)
â”‚  â””â”€ POE API
â”œâ”€ child_process (Node.js)
â”‚  â”œâ”€ git å‘½ä»¤
â”‚  â””â”€ pbcopy å‘½ä»¤
â””â”€ fs & path (Node.js)
   â””â”€ æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
```

---

## ğŸ¯ å…³é”®è®¾è®¡å†³ç­–

| å†³ç­– | ç†ç”± |
|------|------|
| ä½¿ç”¨ POE API | æ”¯æŒå¤šä¸ªå¼ºå¤§æ¨¡å‹ï¼Œæ— éœ€å•ç‹¬é›†æˆ |
| Diff å¤§å°é™åˆ¶ 10KB | å¹³è¡¡å®Œæ•´æ€§å’Œ API æˆæœ¬ |
| ç¡¬ç¼–ç  API Key | ç®€åŒ–éƒ¨ç½²ï¼ˆå¯æ”¹ä¸ºç¯å¢ƒå˜é‡ï¼‰ |
| å¼‚æ­¥å‰ªè´´æ¿æ“ä½œ | é¿å…é˜»å¡ï¼Œæå‡å“åº”é€Ÿåº¦ |
| ä¸‰ç§æ¶ˆæ¯æ ¼å¼ | è¦†ç›–ä¸åŒä½¿ç”¨åœºæ™¯ |
| Zod å‚æ•°éªŒè¯ | ç¡®ä¿ç±»å‹å®‰å…¨ |
| FastMCP æ¡†æ¶ | æ ‡å‡†çš„ MCP åè®®å®ç° |

---

## ğŸš€ ä¼˜åŒ–æœºä¼š

1. **ç¼“å­˜å±‚**: 
   - æ¨¡å‹åˆ—è¡¨ç¼“å­˜ï¼ˆTTL: 1 å°æ—¶ï¼‰
   - æœ€è¿‘åˆ†æç»“æœç¼“å­˜

2. **å¹¶å‘ä¼˜åŒ–**:
   - å¹¶è¡Œæ”¶é›† Git ä¿¡æ¯
   - å¹¶è¡Œè°ƒç”¨å¤šä¸ªæ¨¡å‹

3. **AI ä¼˜åŒ–**:
   - ä¸Šä¸‹æ–‡å‹ç¼©ç®—æ³•
   - æ¨¡å‹é€‰æ‹©è‡ªé€‚åº”

4. **ç”¨æˆ·ä½“éªŒ**:
   - è¿›åº¦æç¤º
   - ç»“æœé¢„è§ˆ
   - äº¤äº’å¼é€‰æ‹©

---

## ğŸ“ æ€»ç»“

Git Message MCP é‡‡ç”¨äº†**æ¨¡å—åŒ–ã€å¯ç»´æŠ¤ã€å¯æ‰©å±•**çš„æ¶æ„è®¾è®¡ï¼š

- âœ… **æ¸…æ™°çš„èŒè´£åˆ†å·¥** - æ¯ä¸ªæ¨¡å—ç‹¬ç«‹
- âœ… **çµæ´»çš„æ•°æ®æµ** - æ˜“äºè¿½è¸ªå’Œè°ƒè¯•
- âœ… **å®Œå–„çš„é”™è¯¯å¤„ç†** - ç”¨æˆ·å‹å¥½çš„åé¦ˆ
- âœ… **å……åˆ†çš„å¯æ‰©å±•æ€§** - æ”¯æŒæ–°åŠŸèƒ½æ·»åŠ 
- âœ… **å¥å…¨çš„å®‰å…¨æœºåˆ¶** - ä¿æŠ¤ç”¨æˆ·æ•°æ®

è¿™ä¸ªè®¾è®¡ä½¿å¾—ç³»ç»Ÿæ—¢ç®€æ´æ˜“æ‡‚ï¼Œåˆè¶³å¤Ÿå¼ºå¤§å’Œçµæ´»ã€‚

